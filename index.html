<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>Space Sandbox</title>
<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:black;
  font-family:system-ui;
}
canvas{display:block;}

#menu{
  position:fixed;
  top:20px;
  right:20px;
  background:rgba(0,0,0,0.6);
  border:1px solid rgba(255,255,255,0.2);
  padding:10px;
  border-radius:10px;
}
button{
  display:block;
  margin:6px 0;
  width:140px;
  background:#111;
  color:white;
  border:1px solid #333;
  padding:8px;
  cursor:pointer;
}
button.active{border-color:white;}
</style>
</head>
<body>

<canvas id="c"></canvas>

<div id="menu">
  <button data-type="blackhole">üï≥ Black Hole</button>
  <button data-type="planet">ü™ê Planet</button>
  <button id="reset">‚ôª Reset</button>
</div>

<script>
console.log("GRAVITY VERSION LOADED");

const c = document.getElementById("c");
const ctx = c.getContext("2d");
c.width = innerWidth;
c.height = innerHeight;

let mode = null;
const stars = [];
const objects = [];
const rockets = [];

const G = 0.15; // gravitationskonstant

class Body{
  constructor(x,y,mass){
    this.x=x; this.y=y;
    this.vx=0; this.vy=0;
    this.mass=mass;
  }
  applyGravity(other){
    const dx = other.x-this.x;
    const dy = other.y-this.y;
    const d = Math.sqrt(dx*dx+dy*dy)+0.1;
    const f = G * other.mass / (d*d);
    this.vx += dx/d * f;
    this.vy += dy/d * f;
  }
  update(){
    this.x+=this.vx;
    this.y+=this.vy;
  }
}

class Star extends Body{
  constructor(){
    super(Math.random()*c.width,Math.random()*c.height,1);
    this.size=Math.random()*1.5+0.5;
  }
  draw(){
    ctx.fillStyle="white";
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fill();
  }
}

class Planet extends Body{
  constructor(x,y){
    super(x,y,400);
    this.r=18;
  }
  draw(){
    const g = ctx.createRadialGradient(this.x-5,this.y-5,5,this.x,this.y,this.r);
    g.addColorStop(0,"#6fbfff");
    g.addColorStop(1,"#1b3d6b");
    ctx.fillStyle=g;
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.r,0,Math.PI*2);
    ctx.fill();
  }
}

class BlackHole extends Body{
  constructor(x,y){
    super(x,y,2000);
    this.r=35;
  }
  draw(){
    ctx.fillStyle="black";
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.r,0,Math.PI*2);
    ctx.fill();

    ctx.strokeStyle="rgba(255,255,255,0.2)";
    ctx.lineWidth=2;
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.r+10,0,Math.PI*2);
    ctx.stroke();
  }
}

class Rocket extends Body{
  constructor(){
    super(-100,Math.random()*c.height,200);
    this.vx=2;
  }
  draw(){
    ctx.fillStyle="white";
    ctx.fillRect(this.x,this.y,30,6);
    ctx.fillStyle="orange";
    ctx.fillRect(this.x-8,this.y+1,6,4);
  }
}

// init
for(let i=0;i<1200;i++) stars.push(new Star());
rockets.push(new Rocket());

document.querySelectorAll("button[data-type]").forEach(b=>{
  b.onclick=()=>{
    document.querySelectorAll("button").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    mode=b.dataset.type;
  }
});

document.getElementById("reset").onclick=()=>{
  objects.length=0;
};

addEventListener("click",e=>{
  if(e.clientX>c.width-200) return;
  if(mode==="planet") objects.push(new Planet(e.clientX,e.clientY));
  if(mode==="blackhole") objects.push(new BlackHole(e.clientX,e.clientY));
});

addEventListener("resize",()=>{
  c.width=innerWidth;
  c.height=innerHeight;
});

function applyGravityAll(bodies){
  bodies.forEach(a=>{
    objects.forEach(o=>{
      if(a!==o) a.applyGravity(o);
    });
  });
}

function loop(){
  ctx.fillStyle="rgba(0,0,0,0.25)";
  ctx.fillRect(0,0,c.width,c.height);

  applyGravityAll(stars);
  applyGravityAll(objects);
  applyGravityAll(rockets);

  [...stars,...objects,...rockets].forEach(b=>{
    b.update();
    b.draw();
  });

  rockets.forEach(r=>{
    if(r.x>c.width+100){
      r.x=-200;
      r.y=Math.random()*c.height;
      r.vx=2;
      r.vy=0;
    }
  });

  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
