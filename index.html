<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dark Market Simulator</title>

<style>
:root{
--bg:#0b0f14;
--panel:#111827;
--border:#1f2937;
--text:#e5e7eb;
--muted:#9ca3af;
--green:#22c55e;
--red:#ef4444;
}

*{box-sizing:border-box;font-family:system-ui,sans-serif}
body{margin:0;background:var(--bg);color:var(--text)}

header{
display:flex;justify-content:space-between;align-items:center;
padding:20px 30px;border-bottom:1px solid var(--border)
}

h1{margin:0;font-size:20px}

.stats span{margin-left:20px;font-weight:600}

main{padding:30px;max-width:1200px;margin:auto}

.market,.portfolio{
background:var(--panel);
border:1px solid var(--border);
border-radius:10px;
margin-bottom:30px;
overflow:hidden
}

.market-header,.row{
display:grid;
grid-template-columns:1.5fr 1fr 1fr 1fr 1fr 1fr;
padding:14px 15px;
align-items:center
}

.market-header{
background:#0f172a;
font-size:13px;
color:var(--muted);
text-transform:uppercase
}

.row{border-top:1px solid var(--border)}
.row:hover{background:#020617}

input{
width:60px;
background:#020617;
border:1px solid var(--border);
color:white;
padding:5px;
border-radius:5px
}

button{
padding:6px 10px;
border:none;
border-radius:6px;
cursor:pointer;
font-weight:600
}

.buy{background:var(--green);color:black}
.sell{background:var(--red);color:black}

.green{color:var(--green)}
.red{color:var(--red)}

</style>
</head>

<body>

<header>
<h1>DARK MARKET</h1>
<div class="stats">
<span>Cash: $<span id="cash"></span></span>
<span>Portfolio Value: $<span id="value"></span></span>
<span>P/L: <span id="pl"></span></span>
</div>
</header>

<main>

<div class="market">
<div class="market-header">
<div>Company</div>
<div>Price</div>
<div>Change</div>
<div>Shares</div>
<div>Buy</div>
<div>Sell</div>
</div>
<div id="stocks"></div>
</div>

<div class="portfolio">
<div class="market-header">
<div>Your Holdings</div>
<div>Shares</div>
<div>Avg Price</div>
<div>Current</div>
<div>Value</div>
<div>P/L</div>
</div>
<div id="portfolio"></div>
</div>

</main>

<script>
let cash = parseFloat(localStorage.getItem("cash")) || 100000;
let portfolio = JSON.parse(localStorage.getItem("portfolio")) || {};

let stocks = [
{ticker:"NXAI",name:"Nexora AI",price:142},
{ticker:"BLKW",name:"Blackwave Industries",price:87},
{ticker:"VRTX",name:"Vertex Dynamics",price:59},
{ticker:"OMNI",name:"OmniCore Systems",price:212},
{ticker:"CYBR",name:"Cyberion Security",price:134},
{ticker:"AETH",name:"Aether Energy",price:73}
];

function renderStocks(){
const container=document.getElementById("stocks");
container.innerHTML="";
stocks.forEach(stock=>{
let change=(Math.random()*4-2).toFixed(2);
stock.price=(stock.price*(1+change/100));
container.innerHTML+=`
<div class="row">
<div>${stock.ticker} <span style="color:gray;font-size:12px">${stock.name}</span></div>
<div>$${stock.price.toFixed(2)}</div>
<div class="${change>=0?'green':'red'}">${change}%</div>
<div><input type="number" min="1" value="1" id="qty-${stock.ticker}"></div>
<div><button class="buy" onclick="buy('${stock.ticker}')">Buy</button></div>
<div><button class="sell" onclick="sell('${stock.ticker}')">Sell</button></div>
</div>
`;
});
}

function buy(ticker){
let stock=stocks.find(s=>s.ticker===ticker);
let qty=parseInt(document.getElementById("qty-"+ticker).value);
let cost=stock.price*qty;
if(cost>cash)return alert("Not enough cash");

cash-=cost;
if(!portfolio[ticker]){
portfolio[ticker]={shares:0,totalCost:0};
}
portfolio[ticker].shares+=qty;
portfolio[ticker].totalCost+=cost;

save();
updateUI();
}

function sell(ticker){
if(!portfolio[ticker])return;
let stock=stocks.find(s=>s.ticker===ticker);
let qty=parseInt(document.getElementById("qty-"+ticker).value);
if(qty>portfolio[ticker].shares)return alert("Not enough shares");

let revenue=stock.price*qty;
cash+=revenue;
portfolio[ticker].shares-=qty;
portfolio[ticker].totalCost-=portfolio[ticker].totalCost*(qty/(portfolio[ticker].shares+qty));

if(portfolio[ticker].shares===0)delete portfolio[ticker];

save();
updateUI();
}

function updateUI(){
document.getElementById("cash").innerText=cash.toFixed(2);

let portDiv=document.getElementById("portfolio");
portDiv.innerHTML="";
let totalValue=0;
let totalCost=0;

for(let ticker in portfolio){
let stock=stocks.find(s=>s.ticker===ticker);
let shares=portfolio[ticker].shares;
let avg=portfolio[ticker].totalCost/shares;
let value=stock.price*shares;
let pl=value-portfolio[ticker].totalCost;

totalValue+=value;
totalCost+=portfolio[ticker].totalCost;

portDiv.innerHTML+=`
<div class="row">
<div>${ticker}</div>
<div>${shares}</div>
<div>$${avg.toFixed(2)}</div>
<div>$${stock.price.toFixed(2)}</div>
<div>$${value.toFixed(2)}</div>
<div class="${pl>=0?'green':'red'}">$${pl.toFixed(2)}</div>
</div>
`;
}

document.getElementById("value").innerText=totalValue.toFixed(2);
let totalPL=totalValue-totalCost;
document.getElementById("pl").innerHTML=
`<span class="${totalPL>=0?'green':'red'}">$${totalPL.toFixed(2)}</span>`;
}

function save(){
localStorage.setItem("cash",cash);
localStorage.setItem("portfolio",JSON.stringify(portfolio));
}

setInterval(()=>{
renderStocks();
updateUI();
},3000);

renderStocks();
updateUI();
</script>

</body>
</html>
