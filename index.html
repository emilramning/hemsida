<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>Cosmic Flow</title>
<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:black;
  cursor:none;
}
canvas{
  display:block;
}
</style>
</head>
<body>

<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
let w = canvas.width = innerWidth;
let h = canvas.height = innerHeight;

const mouse = {x:w/2,y:h/2};
const particles = [];
const COUNT = 1200;

class Particle{
  constructor(){
    this.reset();
  }
  reset(){
    this.x = Math.random()*w;
    this.y = Math.random()*h;
    this.vx = 0;
    this.vy = 0;
    this.size = Math.random()*1.5 + 0.3;
    this.hue = Math.random()*360;
  }
  update(){
    let dx = mouse.x - this.x;
    let dy = mouse.y - this.y;
    let dist = Math.sqrt(dx*dx + dy*dy) || 1;

    // spiral force
    let force = Math.min(150/dist, 3);
    let angle = Math.atan2(dy, dx) + Math.sin(dist*0.02)*0.5;

    this.vx += Math.cos(angle)*force*0.03;
    this.vy += Math.sin(angle)*force*0.03;

    this.vx *= 0.96;
    this.vy *= 0.96;

    this.x += this.vx;
    this.y += this.vy;

    if(this.x<0||this.x>w||this.y<0||this.y>h) this.reset();
    this.hue += 0.5;
  }
  draw(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fillStyle = `hsla(${this.hue},100%,70%,0.8)`;
    ctx.shadowBlur = 15;
    ctx.shadowColor = `hsla(${this.hue},100%,70%,1)`;
    ctx.fill();
  }
}

for(let i=0;i<COUNT;i++) particles.push(new Particle());

function animate(){
  ctx.fillStyle="rgba(0,0,0,0.15)";
  ctx.fillRect(0,0,w,h);
  particles.forEach(p=>{
    p.update();
    p.draw();
  });
  requestAnimationFrame(animate);
}

addEventListener("mousemove",e=>{
  mouse.x = e.clientX;
  mouse.y = e.clientY;
});

addEventListener("click",()=>{
  particles.forEach(p=>{
    let dx = p.x-mouse.x;
    let dy = p.y-mouse.y;
    let d = Math.sqrt(dx*dx+dy*dy)||1;
    let f = 30/d;
    p.vx += dx*f;
    p.vy += dy*f;
  });
});

addEventListener("resize",()=>{
  w = canvas.width = innerWidth;
  h = canvas.height = innerHeight;
});

animate();
</script>

</body>
</html>
